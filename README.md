# دسته‌بندی کیفیت شراب – مدل‌سازی حساس به هزینه

## مسئله
دیتاست شامل امتیاز کیفیت شراب (ابتدا 3–8) با توزیع نامتعادل کلاس‌هاست.
هدف، دسته‌بندی شراب‌ها به کلاس‌های کیفیت است، در حالی که تاثیر مالی و اعتماد مشتری در اشتباهات مدل لحاظ شود.

چون تعداد نمونه‌ها در برخی کلاس‌ها کم بود، مدل کردن همه کلاس‌ها باعث ناپایداری و سوگیری به سمت کلاس‌های پرتکرار می‌شد.

## رویکرد
- **تغییر هدف:** تعداد کلاس‌ها از شش به سه کاهش یافت تا پیش‌بینی‌ها پایدارتر شوند و نویز کاهش یابد. این تغییر روی همپوشانی ویژگی‌ها تاثیری نداشت، اما مدل قابل اعتمادتر شد.
- **انتخاب مدل:** چند مدل مختلف با Grid Search بررسی شد؛ **Random Forest** به دلیل پایداری و عملکرد مناسب انتخاب شد.
- **تصمیم‌گیری حساس به هزینه:** هزینه اشتباه برای کلاس‌ها متفاوت است. به جای تنظیم threshold، یک **تابع هزینه سفارشی** تعریف شد تا دقت برای شراب‌های با کیفیت بالا حفظ شود و تعادل recall برای بقیه کلاس‌ها برقرار شود.

## نتایج
- **شراب با کیفیت بالا:** دقت ۸۴٪ → اعتماد مشتری حفظ شد.
- **Recall:** ۵۰٪ برای کلاس با کیفیت بالا تا تعادل برای سایر کلاس‌ها برقرار شود.
- **عملکرد کلی:**
  - Macro Fβ-score (β=0.7) ≈ 0.70
  - دقت کلی f1-score-weighted ≈ ۷۲٪

- ماتریس درهم‌ریختگی و گزارش دسته‌بندی نشان می‌دهد مدل رفتار موردنظر در سناریوی حساس به هزینه را رعایت کرده است.



---
**MohammadRezaMahdyan**  
[![GitHub](https://img.shields.io/badge/GitHub-MohammadRezaMahdyan-black?logo=github&logoColor=white)](https://github.com/MohammadRezaMahdyan)

